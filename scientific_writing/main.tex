\documentclass[10pt]{llncs}

%\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

\author{Enrico Steffinlongo}
%\institute{Universit\`{a} Ca' Foscari Venezia}
%\title{Relationship Based Access Control Model: Formal Definition and Verification}
\title{Enforcing security of browser extensions: a static analysis approach}

\begin{document}
\maketitle

\begin{abstract}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur convallis orci quis ipsum placerat, eu convallis velit cursus. Proin urna nunc, fringilla vel mi in, venenatis blandit sem. Fusce interdum at lectus non ultricies. Sed aliquet eleifend nibh, non viverra urna rhoncus ac. Fusce sit amet dictum eros. Ut nec sodales lorem. Phasellus egestas velit gravida orci mattis, in facilisis justo elementum. Donec massa tellus, fermentum ac est in, lacinia commodo sapien.
\end{abstract}

\section{Introduction}
In the last years web browsers evolved becoming very powerful and complex software. To enhance their capabilities, modern browsers provide very powerful extension architectures. Such architectures offer a simple API designed to build extensions that expose to the extension the user interface, web communication and internal components of the browser. While some extensions work just modifying the user interface, others perform security critical operations like access to the cookie jar, download manager, password storage. Hence the security of the user private data is strictly bound with the security of the extension installed in the browser. Moreover since browser extensions interact with web pages, that are potentially malicious, they expand the attack surface of the browser. To mitigate this threat they rely on strong security principles like privilege separation \cite{ChromeExtSpec}.

Another problem is that browser extensions are written in JavaScript, and for JavaScript there are really few tools to help programmers in the development. Moreover there are almost no tools to check statically web applications and browser extensions.

To comply with security warranties, various approaches have been adopted in different fields. Some researchers focus on definition of a robust architecture \cite{ChromeExtSpec}, \cite{ChromeExtSpecSnd} and \cite{PriviSep}, such as privilege separated ones where all components are separated, permissions are given to each component, and all inter-component communications are allowed only to a restricted message passing interface in order to reduce the damage done by a compromised component. On the other side, other works focus on static analysis of JavaScript in order to give to programmers information about the application. This second approach uses techniques derived from program analysis \cite{PrincipleProgramAnalysis} such flow logic \cite{FlowLogic}, typing \cite{TAJS} \cite{strobe}, and abstract interpretation \cite{LambdaJSMightVanHorn}.

Even if both approaches mitigate various threats, and give powerful tools to developers, they are not a real panacea, because the aggressive dynamic typing of JavaScript is hard to statically check and there is not a standard semantics for it. Moreover privilege separated architectures are affected by privilege escalation attacks where a compromised component with low permissions can tamper with the message passing interface, asking the execution of a privilege to a component not directly compromised with higher permissions.

The aim of this work is to combine both architectural and static approaches to give developers an upper bound of the permissions used by each component of the extension even if they are compromised. We devised a model of the Google Chrome extension architecture  \cite{ChromeExtensionAPI}, then we analyzed the JavaScript code of the extension according to the model, using a simpler semantics as described in \cite{LambdaJS} and the flow logic approach to derive permissions of all components. Finally we developed CHEN (CHrome Extension aNalyzer), a tool written in F\# that performs such analysis and we further used it in order to find some issues even in real extension such as ShareMeNot \cite{ShareMeNot}.

\section{Background}
Google Chrome extension architecture is built around a privilege separated architecture that uses the least privilege principle. In it an extension is divided in a \texttt{Extension Core} component, and various \texttt{Content Scripts}. The former component is centralized, has all privileges used by the extension, and do not have access to the web pages since these are potentially malicious. \texttt{Content scripts} instead are components that are injected to web pages, they have no privileges except the one used to send messages to the \texttt{Extension Core}. In this architecture if a \texttt{Content Script} have to exercise a privilege it has to send a message to the background that can satisfy the request.

This behavior enforce the extension since a compromised component cannot perform security critical operations, but is yet allowed to ask to the \texttt{Extension Core}. To better understand this problem let us consider an extension composed of three components: Extension Core E, and two Content Scripts namely CS1 and CS2. Let say that Component CS1 only sends messages to E asking for access to the cookie jar, while CS2 ask only password storage.


\section{Conclusions}

%\cite{*}


\bibliographystyle{splncs03}
\bibliography{thesis}

\end{document}